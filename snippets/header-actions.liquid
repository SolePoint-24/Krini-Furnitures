{% comment %} 
  --- SCRIPT TO FIX DISAPPEARING COUNT ---
  REPLACE your old script at the bottom of header-actions.liquid with this one.
{% endcomment %}
<script>
  function updateCompareCountOnHeader() {
    const countElement = document.querySelector('.compare-count');
    if (countElement) {
      const compareList = JSON.parse(localStorage.getItem('compareList')) || [];
      countElement.textContent = compareList.length;
      
      if (compareList.length > 0) {
        countElement.style.display = 'flex';
      } else {
        countElement.style.display = 'none';
      }
    }
  }
  
  // Run when the page is loaded (DOMContentLoaded)
  document.addEventListener('DOMContentLoaded', updateCompareCountOnHeader);
  
  // Run when our custom event is sent from compare.js
  document.addEventListener('compare:updated', updateCompareCountOnHeader);

  // Also run if the cart is updated (as a final fallback)
  document.addEventListener('cart:updated', updateCompareCountOnHeader);
</script>
