{% comment %}
  ** Custom Image Banner Section **
  - Background image with overlay
  - Customizable title and description using theme fonts
  - Up to two buttons using theme's primary/secondary styles
  - Fully configurable via the theme editor
{% endcomment %}

{%- liquid
  assign title = section.settings.title
  assign description = section.settings.description
  assign text_color = section.settings.text_color
  assign alignment = section.settings.content_alignment
  assign height = section.settings.section_height
  assign overlay_color = section.settings.overlay_color
  assign overlay_opacity = section.settings.overlay_opacity

  assign btn1_label = section.settings.button_1_label
  assign btn1_link = section.settings.button_1_link

  # --- CORRECTED LOGIC FOR BUTTON 1 STYLE ---
  if section.settings.button_1_is_secondary
    assign btn1_style_class = 'button--secondary'
  else
    assign btn1_style_class = 'button--primary'
  endif

  assign btn2_label = section.settings.button_2_label
  assign btn2_link = section.settings.button_2_link

  # --- CORRECTED LOGIC FOR BUTTON 2 STYLE ---
  if section.settings.button_2_is_secondary
    assign btn2_style_class = 'button--secondary'
  else
    assign btn2_style_class = 'button--primary'
  endif
-%}

<style>
  .custom-banner {
    --section-height: {{ height }}vh;
    --text-color: {{ text_color }};
    --overlay-color: {{ overlay_color }};
    --overlay-opacity: {{ overlay_opacity }};
    --content-justify: {% if alignment contains 'center' %}center{% elsif alignment contains 'left' %}flex-start{% else %}flex-end{% endif %};
    --content-align: {% if alignment contains 'middle' %}center{% elsif alignment contains 'top' %}flex-start{% else %}flex-end{% endif %};
    --text-align: {% if alignment contains 'center' %}center{% elsif alignment contains 'left' %}left{% else %}right{% endif %};

    position: relative;
    display: flex;
    min-height: var(--section-height);
    background-size: cover;
    background-position: center;
    color: var(--text-color);
  }

  .custom-banner__background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
  }

  .custom-banner__background img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .custom-banner__overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--overlay-color);
    opacity: var(--overlay-opacity);
    z-index: 1;
  }

  .custom-banner__content {
    position: relative;
    z-index: 2;
    width: 100%;
    max-width: 1200px;
    margin: auto;
    padding: 2rem;
    display: flex;
    flex-direction: column;
    justify-content: var(--content-align);
    align-items: var(--content-justify);
    text-align: var(--text-align);
  }

  .custom-banner__title {
    /* Uses theme's heading styles. You can change 'h1' to 'h2', etc. */
    margin-bottom: 15px;
  }

  .custom-banner__description {
    /* Uses theme's rich text editor styles */
    max-width: 60ch;
    margin-bottom: 25px;
  }

  .custom-banner__buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: var(--text-align);
  }
</style>

<div
  class="custom-banner"
  style="
    {%- if section.settings.background_image != blank -%}
      background-image: url('{{ section.settings.background_image | image_url: width: 1920 }}');
    {%- endif -%}
  "
>
  <div class="custom-banner__overlay"></div>

  <div class="custom-banner__content">
    <div class="custom-banner__box">
      {%- if title != blank -%}
        <h2 class="custom-banner__title h1">{{ title | escape }}</h2>
      {%- endif -%}

      {%- if description != blank -%}
        <div class="custom-banner__description rte">{{ description }}</div>
      {%- endif -%}

      {%- if btn1_label != blank or btn2_label != blank -%}
        <div class="custom-banner__buttons">
          {%- if btn1_label != blank and btn1_link != blank -%}
            <a href="{{ btn1_link }}" class="button {{ btn1_style_class }}">
              {{ btn1_label | escape }}
            </a>
          {%- endif -%}
          {%- if btn2_label != blank and btn2_link != blank -%}
            <a href="{{ btn2_link }}" class="button {{ btn2_style_class }}">
              {{ btn2_label | escape }}
            </a>
          {%- endif -%}
        </div>
      {%- endif -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Image Banner",
  "tag": "section",
  "class": "section-custom-image-banner",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.image-banner.settings.header.image.content"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "t:sections.image-banner.settings.image.label"
    },
    {
      "type": "header",
      "content": "t:sections.image-banner.settings.header.layout.content"
    },
    {
      "type": "range",
      "id": "section_height",
      "min": 30,
      "max": 100,
      "step": 5,
      "unit": "vh",
      "label": "t:sections.image-banner.settings.section_height.label",
      "default": 65
    },
    {
      "type": "select",
      "id": "content_alignment",
      "label": "t:sections.image-banner.settings.content_alignment.label",
      "options": [
        { "value": "top-left", "label": "t:sections.image-banner.settings.content_alignment.options.top-left.label" },
        { "value": "top-center", "label": "t:sections.image-banner.settings.content_alignment.options.top-center.label" },
        { "value": "top-right", "label": "t:sections.image-banner.settings.content_alignment.options.top-right.label" },
        { "value": "middle-left", "label": "t:sections.image-banner.settings.content_alignment.options.middle-left.label" },
        { "value": "middle-center", "label": "t:sections.image-banner.settings.content_alignment.options.middle-center.label" },
        { "value": "middle-right", "label": "t:sections.image-banner.settings.content_alignment.options.middle-right.label" },
        { "value": "bottom-left", "label": "t:sections.image-banner.settings.content_alignment.options.bottom-left.label" },
        { "value": "bottom-center", "label": "t:sections.image-banner.settings.content_alignment.options.bottom-center.label" },
        { "value": "bottom-right", "label": "t:sections.image-banner.settings.content_alignment.options.bottom-right.label" }
      ],
      "default": "middle-center"
    },
    {
      "type": "header",
      "content": "t:sections.image-banner.settings.header.content.content"
    },
    {
      "type": "text",
      "id": "title",
      "label": "t:sections.image-banner.settings.title.label",
      "default": "Image Banner"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "t:sections.image-banner.settings.description.label",
      "default": "<p>Give your customers insight into your brand. Select imagery and text that relates to your style and story.</p>"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "t:sections.image-banner.settings.text_color.label",
      "default": "#FFFFFF"
    },
    {
      "type": "header",
      "content": "t:sections.image-banner.settings.header.overlay.content"
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "t:sections.image-banner.settings.overlay_color.label",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 1,
      "step": 0.1,
      "label": "t:sections.image-banner.settings.overlay_opacity.label",
      "default": 0.3
    },
    {
      "type": "header",
      "content": "t:sections.image-banner.settings.header.button_1.content"
    },
    {
      "type": "text",
      "id": "button_1_label",
      "label": "t:sections.image-banner.settings.button_1_label.label",
      "default": "Shop All"
    },
    {
      "type": "url",
      "id": "button_1_link",
      "label": "t:sections.image-banner.settings.button_1_link.label"
    },
    {
      "type": "checkbox",
      "id": "button_1_is_secondary",
      "label": "t:sections.image-banner.settings.button_1_is_secondary.label",
      "default": false
    },
    {
      "type": "header",
      "content": "t:sections.image-banner.settings.header.button_2.content"
    },
    {
      "type": "text",
      "id": "button_2_label",
      "label": "t:sections.image-banner.settings.button_2_label.label"
    },
    {
      "type": "url",
      "id": "button_2_link",
      "label": "t:sections.image-banner.settings.button_2_link.label"
    },
    {
      "type": "checkbox",
      "id": "button_2_is_secondary",
      "label": "t:sections.image-banner.settings.button_2_is_secondary.label",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Image Banner"
    }
  ],
  "locales": {
    "en": {
      "sections": {
        "image-banner": {
          "settings": {
            "header": {
              "image": {
                "content": "Image"
              },
              "layout": {
                "content": "Layout"
              },
              "content": {
                "content": "Content"
              },
              "overlay": {
                "content": "Overlay"
              },
              "button_1": {
                "content": "Button 1"
              },
              "button_2": {
                "content": "Button 2"
              }
            },
            "image": {
              "label": "Background image"
            },
            "section_height": {
              "label": "Section height"
            },
            "content_alignment": {
              "label": "Content alignment",
              "options": {
                "top-left": { "label": "Top left" },
                "top-center": { "label": "Top center" },
                "top-right": { "label": "Top right" },
                "middle-left": { "label": "Middle left" },
                "middle-center": { "label": "Middle center" },
                "middle-right": { "label": "Middle right" },
                "bottom-left": { "label": "Bottom left" },
                "bottom-center": { "label": "Bottom center" },
                "bottom-right": { "label": "Bottom right" }
              }
            },
            "title": {
              "label": "Title"
            },
            "description": {
              "label": "Description"
            },
            "text_color": {
              "label": "Text color"
            },
            "overlay_color": {
              "label": "Overlay color"
            },
            "overlay_opacity": {
              "label": "Overlay opacity"
            },
            "button_1_label": {
              "label": "Button label"
            },
            "button_1_link": {
              "label": "Button link"
            },
            "button_1_is_secondary": {
              "label": "Use secondary button style"
            },
            "button_2_label": {
              "label": "Button label"
            },
            "button_2_link": {
              "label": "Button link"
            },
            "button_2_is_secondary": {
              "label": "Use secondary button style"
            }
          }
        }
      }
    }
  }
}
{% endschema %}