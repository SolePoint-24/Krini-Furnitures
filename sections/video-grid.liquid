<div class="section-{{ section.id }} video-grid-section ">
  <div class="video-grid-header page-width ">
    {% if section.settings.heading != blank %}
      <h2 class="video-grid-heading">{{ section.settings.heading | escape }}</h2>
    {% endif %}
    {% if section.settings.description != blank %}
      <div class="video-grid-description rte">
        {{ section.settings.description }}
      </div>
    {% endif %}
  </div>

  {% if section.blocks.size > 0 %}
    <div class="video-grid-container page-width">
      {% for block in section.blocks %}
        {% liquid
          assign video_id = block.settings.video_url | split: 'v=' | last | split: '&' | first | split: 'youtu.be/' | last
        %}

        <div class="video-grid-item" {{ block.shopify_attributes }}>
          <iframe
            src="https://www.youtube.com/embed/{{ video_id }}?rel=0&modestbranding=1"
            title="YouTube video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
          ></iframe>
        </div>
      {% endfor %}
    </div>
  {% endif %}
</div>

<style>
    .section-{{ section.id }} {
      padding: 50px 0;
    }

    /* --- THIS IS THE CORRECTED PADDING --- */
    .page-width {
      max-width: 1440px; 
      margin: 0 auto;
    }
    @media (min-width: 768px) {
      .page-width {
        padding: 0 40px; /* Desktop padding */
      }
    }
    /* --- END OF PADDING FIX --- */

    .video-grid-header {
      text-align: center;
      margin-bottom: 40px;
    }

    .video-grid-heading {
      margin-bottom: 30px;
    }

    .video-grid-description {
      text-align: left; 
    }

    .video-grid-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr); /* Default is 3 columns */
      gap: 30px;
    }

    .video-grid-item {
      overflow: hidden;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
    }

    .video-grid-item iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    /* --- THIS IS THE CORRECTED LOGIC FOR 1 OR 2 VIDEOS --- */
    @media (min-width: 769px) { /* 1px above the tablet breakpoint */
      
      /* If there is only 1 video, make it 1 column and center it */
      .video-grid-container[data-block-count="1"] {
        grid-template-columns: 1fr;
        max-width: 680px; /* Adjust as needed */
        margin-left: auto;
        margin-right: auto;
      }
      
      /* If there are 2 videos, make it 2 columns and center them */
      .video-grid-container[data-block-count="2"] {
        grid-template-columns: repeat(2, 1fr);
        max-width: 1000px; 
        margin-left: auto;
        margin-right: auto;
      }
    }
    /* --- END OF NEW LOGIC --- */


    /* Tablet Responsive */
    @media (max-width: 768px) {
      .video-grid-container {
        /* On tablet, 2 columns is fine for 1, 2, or 3 videos */
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
      }
    }

    /* Mobile Responsive */
    @media (max-width: 480px) {
      .video-grid-container {
        grid-template-columns: 1fr;
      }
    }
</style>

{% schema %}
{
  "name": "Video Grid",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Wall Bed Concepts"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>A wall bed, also known as a Murphy bed, is a dual purpose piece of furniture that can help you create a practical space for your home without sacrificing comfort.</p>"
    }
  ],
  "blocks": [
    {
      "type": "video",
      "name": "Video",
      "settings": [
        {
          "type": "url",
          "id": "video_url",
          "label": "YouTube Video URL",
          "info": "Paste the full YouTube URL (e.g., https://www.youtube.com/watch?v=...)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Video Grid",
      "blocks": [{ "type": "video" }, { "type": "video" }, { "type": "video" }]
    }
  ]
}
{% endschema %}
