{%- liquid
  assign s = section.settings
  assign image_width_class = 'w-' | append: s.image_width
  assign text_width_class = 'w-' | append: 100 | minus: s.image_width
  assign horizontal_alignment_classes = 'items-' | append: s.horizontal_alignment | append: ' justify-' | append: s.horizontal_alignment
  assign vertical_alignment_class = 'items-' | append: s.vertical_alignment

  assign text_alignment_css = 'text-align: ' | append: s.text_alignment
-%}

<section
  class="section-image-with-text isolate padding-block-end-{{ s.padding_bottom }} padding-block-start-{{ s.padding_top }}"
  data-section-type="image-with-text"
  data-section-id="{{ section.id }}"
>
  <div class="container container--{{ s.container_size }}">
    <div
      class="
        section-image-with-text__wrapper
        flex
        flex-col
        gap-l
        {% if s.reverse_layout %}flex-col-reverse md:flex-row-reverse{% else %}md:flex-row{% endif %}
        {{ horizontal_alignment_classes }}
        {{ vertical_alignment_class }}
      "
    >
      <div class="section-image-with-text__image {{ image_width_class }}">
        {% if s.image != blank %}
          <img
            src="{{ s.image | image_url: width: 1500 }}"
            alt="{{ s.image.alt | escape }}"
            loading="lazy"
            width="{{ s.image.width }}"
            height="{{ s.image.height }}"
            class="block w-full h-auto object-cover border-radius-{{ s.image_border_radius }}"
          >
        {% else %}
          <div class="placeholder-svg block w-full h-full border-radius-{{ s.image_border_radius }}">
            {{ 'image' | placeholder_svg_tag: 'placeholder-svg__image' }}
          </div>
        {% endif %}
      </div>

      <div class="section-image-with-text__content {{ text_width_class }} flex flex-col gap-m">
        {% if s.heading != blank %}
          <h2 class="h1" style="{{ text_alignment_css }}">
            {{ s.heading | escape }}
          </h2>
        {% endif %}

        {% if s.subheading != blank %}
          <p class="body-lg" style="{{ text_alignment_css }}">
            {{ s.subheading | escape }}
          </p>
        {% endif %}

        {% if s.text != blank %}
          <div class="rte" style="{{ text_alignment_css }}">
            {{ s.text }}
          </div>
        {% endif %}

        {% if s.button_label != blank and s.button_link != blank %}
          <div class="flex {{ horizontal_alignment_classes }}">
            <a href="{{ s.button_link }}" class="button button--primary">
              {{ s.button_label | escape }}
            </a>
          </div>
        {% endif %}

        <div class="section-image-with-text__blocks flex flex-col gap-m">
          {% for block in section.blocks %}
            {% case block.type %}
              {% when 'richtext' %}
                <div class="rte" {{ block.shopify_attributes }} style="{{ text_alignment_css }}">
                  {{ block.settings.text }}
                </div>
              {% when 'image_text_column' %}
                <div class="flex gap-s {{ horizontal_alignment_classes }}" {{ block.shopify_attributes }} style="{{ text_alignment_css }}">
                  {% if block.settings.icon_image != blank %}
                    <img
                      src="{{ block.settings.icon_image | image_url: width: 50 }}"
                      alt="{{ block.settings.icon_image.alt | escape }}"
                      width="{{ block.settings.icon_image.width }}"
                      height="{{ block.settings.icon_image.height }}"
                      class="h-auto"
                    >
                  {% else %}
                    <div class="placeholder-svg h-10 w-10">
                      {{ 'icon-placeholder' | placeholder_svg_tag: 'placeholder-svg__icon' }}
                    </div>
                  {% endif %}
                  <p class="body-sm">{{ block.settings.text_content | escape }}</p>
                </div>
              {% when 'custom_liquid' %}
                <div {{ block.shopify_attributes }}>
                  {{ block.settings.liquid_code }}
                </div>
              {% when 'horizontal_rule' %}
                <hr class="border-t border-gray-300 w-full my-m" {{ block.shopify_attributes }}>
            {% endcase %}
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Image with Text Section",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "container_size",
      "label": "Container Width",
      "options": [
        { "value": "full", "label": "Full Width" },
        { "value": "lg", "label": "Large" },
        { "value": "md", "label": "Medium" },
        { "value": "sm", "label": "Small" }
      ],
      "default": "lg"
    },
    {
      "type": "range",
      "id": "image_width",
      "label": "Image Width (on desktop)",
      "min": 20,
      "max": 80,
      "step": 5,
      "unit": "%",
      "default": 50
    },
    {
      "type": "checkbox",
      "id": "reverse_layout",
      "label": "Reverse layout (image on right)",
      "default": false
    },
    {
      "type": "select",
      "id": "horizontal_alignment",
      "label": "Horizontal Alignment",
      "options": [
        { "value": "start", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "end", "label": "Right" }
      ],
      "default": "start"
    },
    {
      "type": "select",
      "id": "vertical_alignment",
      "label": "Vertical Alignment",
      "options": [
        { "value": "start", "label": "Top" },
        { "value": "center", "label": "Middle" },
        { "value": "end", "label": "Bottom" }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "image_border_radius",
      "label": "Image Border Radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 10
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "92 MILLION TONS OF TEXTILE WASTE ANNUALLY"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "We turn this challenge into sustainable luxury."
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Rich Text"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button Label"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text Alignment (for section settings content)",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "type": "header",
      "content": "Section Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 36
    }
  ],
  "blocks": [
    {
      "type": "richtext",
      "name": "Rich Text Block",
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "label": "Text",
          "default": "<p>Add a paragraph here.</p>"
        }
      ]
    },
    {
      "type": "image_text_column",
      "name": "Icon with Text",
      "settings": [
        {
          "type": "image_picker",
          "id": "icon_image",
          "label": "Icon Image"
        },
        {
          "type": "text",
          "id": "text_content",
          "label": "Text Content",
          "default": "100% non-hazardous waste sent for recycling..."
        }
      ]
    },
    {
      "type": "horizontal_rule",
      "name": "Horizontal Rule",
      "limit": 1
    },
    {
      "type": "custom_liquid",
      "name": "Custom Liquid",
      "settings": [
        {
          "type": "liquid",
          "id": "liquid_code",
          "label": "Liquid Code",
          "info": "Add custom Liquid code here. Be careful, incorrect code can break your site."
        }
      ]
    }
  ],
  
  "presets": [
    {
      "name": "Image with Text",
      "blocks": [
        {
          "type": "image_text_column"
        },
        {
          "type": "horizontal_rule"
        },
        {
          "type": "image_text_column"
        }
      ]
    }
  ]
}
{% endschema %}


<style>
  @media (min-width: 768px) { /* md: equivalent */
    {% for i in (1..20) %}
      {% assign width_val = i | times: 5 %}
      .w-{{ width_val }} { width: {{ width_val }}%; }
    {% endfor %}
  }

  /* Padding utilities for section */
  .padding-block-start-0 { padding-top: 0; }
  .padding-block-start-4 { padding-top: 4px; }
  .padding-block-start-8 { padding-top: 8px; }
  /* ... add more steps as needed for padding_top range ... */
  .padding-block-start-36 { padding-top: 36px; } /* Example default */
  .padding-block-start-100 { padding-top: 100px; }

  .padding-block-end-0 { padding-bottom: 0; }
  .padding-block-end-4 { padding-bottom: 4px; }
  /* ... add more steps as needed for padding_bottom range ... */
  .padding-block-end-36 { padding-bottom: 36px; } /* Example default */
  .padding-block-end-100 { padding-bottom: 100px; }

  /* Border radius utilities */
  .border-radius-0 { border-radius: 0; }
  .border-radius-10 { border-radius: 10px; }
  .border-radius-20 { border-radius: 20px; }
  .border-radius-50 { border-radius: 50px; }
</style>

{% stylesheet %}
  .section-image-with-text__wrapper {
    /* Base for column layout on mobile, row on desktop */
    flex-wrap: wrap;
  }

  /* Tailwind-like utility classes */
  .flex { display: flex; }
  .flex-col { flex-direction: column; }
  .flex-row { flex-direction: row; }
  .flex-col-reverse { flex-direction: column-reverse; }
  .flex-row-reverse { flex-direction: row-reverse; }

  .gap-s { gap: 8px; }   /* Small gap */
  .gap-m { gap: 16px; }  /* Medium gap */
  .gap-l { gap: 32px; }  /* Large gap */

  .w-full { width: 100%; }
  .h-auto { height: auto; }
  .h-full { height: 100%; }
  .block { display: block; }
  .isolate { isolation: isolate; }
  .object-cover { object-fit: cover; }
  .border-gray-300 { border-color: #d1d5db; } /* Example color */
  .my-m { margin-top: 16px; margin-bottom: 16px; }

  /* Width classes for mobile (default) */
  .w-20, .w-25, .w-30, .w-35, .w-40, .w-45, .w-50, .w-55, .w-60, .w-65, .w-70, .w-75, .w-80, .w-85, .w-90, .w-95, .w-100 {
    width: 100%; /* All columns are full width on mobile */
  }

  /* Desktop layout classes */
  @media (min-width: 768px) { /* md: equivalent */
    .md\:flex-row { flex-direction: row; }
    .md\:flex-row-reverse { flex-direction: row-reverse; }

    .items-start { align-items: flex-start; }
    .items-center { align-items: center; }
    .items-end { align-items: flex-end; }
    .justify-start { justify-content: flex-start; }
    .justify-center { justify-content: center; }
    .justify-end { justify-content: flex-end; }
  }

  /* Placeholder SVG styles (basic) */
  .placeholder-svg {
    background-color: var(--color-background-accent-1, #f7f7f7);
    border: 1px dashed var(--color-border, #d1d5db);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-text, #333);
    min-height: 200px; /* Give placeholder a default height */
  }
  .placeholder-svg__image {
    width: 60%;
    height: 60%;
    opacity: 0.5;
  }
  .placeholder-svg__icon {
    width: 70%;
    height: 70%;
    opacity: 0.5;
  }

  /* Basic container styles */
  .container {
    padding-left: 1rem; /* 16px */
    padding-right: 1rem; /* 16px */
    margin-left: auto;
    margin-right: auto;
  }
  .container--sm { max-width: 640px; }
  .container--md { max-width: 768px; }
  .container--lg { max-width: 1024px; }
  .container--full { max-width: 100%; }

  /* Basic text styles (adjust to your theme's actual styles) */
  .h1 { font-size: 2.5rem; line-height: 1.2; font-weight: bold; } /* Example */
  .body-lg { font-size: 1.125rem; line-height: 1.6; } /* Example */
  .body-sm { font-size: 0.875rem; line-height: 1.5; } /* Example */
  .rte { line-height: 1.6; }
  .rte p { margin-bottom: 1rem; }

  /* Basic button styles (adjust to your theme's actual styles) */
  .button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.75rem 1.5rem;
    border-radius: 0.25rem;
    font-weight: 600;
    text-decoration: none;
    cursor: pointer;
    border: 1px solid transparent;
  }
  .button--primary {
    background-color: var(--color-button, #007bff); /* Example primary color */
    color: var(--color-button-text, #ffffff);
    border-color: var(--color-button, #007bff);
  }
  .button--primary:hover {
    filter: brightness(0.9);
  }
{% endstylesheet %}