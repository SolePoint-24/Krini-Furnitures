{% doc %}
  @prompt
    so what i want to make is that iw ant to make a block that will contain the world map and then i can add some country pin to that map like india usa Canada each country will have different pin color i can add countries pin from the admin how ever i like i want to do something liek that and also make the map beautyful like  user will love looking at that map this map will showcase where we export our products 
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-world-map-{{ ai_gen_id }} {
    padding: {{ block.settings.section_padding }}px 20px;
    background-color: {{ block.settings.background_color }};
  }

  .ai-world-map-container-{{ ai_gen_id }} {
    max-width: {{ block.settings.map_max_width }}px;
    margin: 0 auto;
  }

  .ai-world-map-header-{{ ai_gen_id }} {
    text-align: center;
    margin-bottom: 40px;
  }

  .ai-world-map-title-{{ ai_gen_id }} {
    font-size: {{ block.settings.title_size }}px;
    color: {{ block.settings.title_color }};
    margin: 0 0 12px;
  }

  .ai-world-map-description-{{ ai_gen_id }} {
    font-size: {{ block.settings.description_size }}px;
    color: {{ block.settings.description_color }};
    margin: 0;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  .ai-world-map-wrapper-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    background: {{ block.settings.map_background }};
    border-radius: {{ block.settings.map_border_radius }}px;
    padding: 40px 20px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }

  .ai-world-map-svg-{{ ai_gen_id }} {
    width: 100%;
    height: auto;
    display: block;
  }

  .ai-world-map-svg-{{ ai_gen_id }} path {
    fill: {{ block.settings.land_color }};
    stroke: {{ block.settings.border_color }};
    stroke-width: 0.5;
    transition: fill 0.3s ease;
  }

  .ai-world-map-svg-{{ ai_gen_id }} path:hover {
    fill: {{ block.settings.land_hover_color }};
  }

  .ai-world-map-pins-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }

  .ai-world-map-pin-{{ ai_gen_id }} {
    position: absolute;
    pointer-events: all;
    cursor: pointer;
    transform: translate(-50%, -100%);
  }

  .ai-world-map-pin-marker-{{ ai_gen_id }} {
    width: {{ block.settings.pin_size }}px;
    height: {{ block.settings.pin_size }}px;
    position: relative;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
  }

  .ai-world-map-pin-pulse-{{ ai_gen_id }} {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    transform: translate(-50%, -50%);
    opacity: 0.6;
  }

  .ai-world-map-pin-tooltip-{{ ai_gen_id }} {
    position: absolute;
    bottom: calc(100% + 10px);
    left: 50%;
    transform: translateX(-50%) translateY(10px);
    background: {{ block.settings.tooltip_background }};
    color: {{ block.settings.tooltip_text_color }};
    padding: 8px 12px;
    border-radius: 6px;
    white-space: nowrap;
    font-size: 14px;
    font-weight: 500;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
    pointer-events: none;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    z-index: 10;
  }

  .ai-world-map-pin-tooltip-{{ ai_gen_id }}::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 6px solid transparent;
    border-top-color: {{ block.settings.tooltip_background }};
  }

  .ai-world-map-pin-{{ ai_gen_id }}:hover .ai-world-map-pin-tooltip-{{ ai_gen_id }} {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(0);
  }

  .ai-world-map-legend-{{ ai_gen_id }} {
    margin-top: 30px;
    text-align: center;
  }

  .ai-world-map-legend-title-{{ ai_gen_id }} {
    font-size: 16px;
    font-weight: 600;
    color: {{ block.settings.title_color }};
    margin-bottom: 15px;
  }

  .ai-world-map-legend-items-{{ ai_gen_id }} {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
  }

  .ai-world-map-legend-item-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .ai-world-map-legend-color-{{ ai_gen_id }} {
    width: 16px;
    height: 16px;
    border-radius: 50%;
  }

  .ai-world-map-legend-label-{{ ai_gen_id }} {
    font-size: 14px;
    color: {{ block.settings.description_color }};
  }

  @media screen and (max-width: 749px) {
    .ai-world-map-{{ ai_gen_id }} {
      padding: {{ block.settings.section_padding | times: 0.6 }}px 15px;
    }

    .ai-world-map-title-{{ ai_gen_id }} {
      font-size: {{ block.settings.title_size | times: 0.7 }}px;
    }

    .ai-world-map-description-{{ ai_gen_id }} {
      font-size: {{ block.settings.description_size | times: 0.9 }}px;
    }

    .ai-world-map-wrapper-{{ ai_gen_id }} {
      padding: 20px 10px;
    }

    .ai-world-map-pin-marker-{{ ai_gen_id }} {
      width: {{ block.settings.pin_size | times: 0.8 }}px;
      height: {{ block.settings.pin_size | times: 0.8 }}px;
    }
  }
{% endstyle %}

<world-map-{{ ai_gen_id }} class="ai-world-map-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-world-map-container-{{ ai_gen_id }}">
    {% if block.settings.title != blank or block.settings.description != blank %}
      <div class="ai-world-map-header-{{ ai_gen_id }}">
        {% if block.settings.title != blank %}
          <h2 class="ai-world-map-title-{{ ai_gen_id }}">{{ block.settings.title }}</h2>
        {% endif %}
        {% if block.settings.description != blank %}
          <p class="ai-world-map-description-{{ ai_gen_id }}">{{ block.settings.description }}</p>
        {% endif %}
      </div>
    {% endif %}

    <div class="ai-world-map-wrapper-{{ ai_gen_id }}">
      <svg class="ai-world-map-svg-{{ ai_gen_id }}" viewBox="0 0 1000 500" xmlns="http://www.w3.org/2000/svg">
        <path d="M150,100 L200,80 L250,90 L280,70 L320,85 L350,75 L380,90 L400,80 L420,95 L450,85 L480,100 L500,90 L530,105 L560,95 L590,110 L620,100 L650,115 L680,105 L710,120 L740,110 L770,125 L800,115 L830,130 L850,120 L850,180 L820,190 L790,180 L760,195 L730,185 L700,200 L670,190 L640,205 L610,195 L580,210 L550,200 L520,215 L490,205 L460,220 L430,210 L400,225 L370,215 L340,230 L310,220 L280,235 L250,225 L220,240 L190,230 L160,245 L150,235 Z"/>
        <path d="M200,250 L230,240 L260,255 L290,245 L320,260 L350,250 L380,265 L410,255 L440,270 L470,260 L500,275 L530,265 L560,280 L590,270 L620,285 L650,275 L680,290 L710,280 L740,295 L770,285 L800,300 L800,350 L770,360 L740,350 L710,365 L680,355 L650,370 L620,360 L590,375 L560,365 L530,380 L500,370 L470,385 L440,375 L410,390 L380,380 L350,395 L320,385 L290,400 L260,390 L230,405 L200,395 Z"/>
        <path d="M100,300 L130,290 L160,305 L190,295 L220,310 L250,300 L280,315 L310,305 L340,320 L370,310 L400,325 L430,315 L460,330 L490,320 L520,335 L550,325 L580,340 L610,330 L640,345 L670,335 L700,350 L730,340 L760,355 L790,345 L820,360 L850,350 L850,400 L820,410 L790,400 L760,415 L730,405 L700,420 L670,410 L640,425 L610,415 L580,430 L550,420 L520,435 L490,425 L460,440 L430,430 L400,445 L370,435 L340,450 L310,440 L280,455 L250,445 L220,460 L190,450 L160,465 L130,455 L100,470 Z"/>
      </svg>

      <div class="ai-world-map-pins-{{ ai_gen_id }}">
        {% for i in (1..10) %}
          {% liquid
            assign country_key = 'country_' | append: i
            assign country_name_key = 'country_' | append: i | append: '_name'
            assign country_x_key = 'country_' | append: i | append: '_x'
            assign country_y_key = 'country_' | append: i | append: '_y'
            assign country_color_key = 'country_' | append: i | append: '_color'

            assign country_enabled = block.settings[country_key]
            assign country_name = block.settings[country_name_key]
            assign country_x = block.settings[country_x_key]
            assign country_y = block.settings[country_y_key]
            assign country_color = block.settings[country_color_key]
          %}

          {% if country_enabled and country_name != blank %}
            <div
              class="ai-world-map-pin-{{ ai_gen_id }}"
              style="left: {{ country_x }}%; top: {{ country_y }}%;"
              data-country="{{ country_name }}"
            >
              <div class="ai-world-map-pin-marker-{{ ai_gen_id }}">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="{{ country_color }}"/>
                </svg>
                <div class="ai-world-map-pin-pulse-{{ ai_gen_id }}" style="background-color: {{ country_color }};"></div>
              </div>
              <div class="ai-world-map-pin-tooltip-{{ ai_gen_id }}">
                {{ country_name }}
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>

    {% if block.settings.show_legend %}
      <div class="ai-world-map-legend-{{ ai_gen_id }}">
        <div class="ai-world-map-legend-title-{{ ai_gen_id }}">Export Destinations</div>
        <div class="ai-world-map-legend-items-{{ ai_gen_id }}">
          {% for i in (1..10) %}
            {% liquid
              assign country_key = 'country_' | append: i
              assign country_name_key = 'country_' | append: i | append: '_name'
              assign country_color_key = 'country_' | append: i | append: '_color'

              assign country_enabled = block.settings[country_key]
              assign country_name = block.settings[country_name_key]
              assign country_color = block.settings[country_color_key]
            %}

            {% if country_enabled and country_name != blank %}
              <div class="ai-world-map-legend-item-{{ ai_gen_id }}">
                <div class="ai-world-map-legend-color-{{ ai_gen_id }}" style="background-color: {{ country_color }};"></div>
                <div class="ai-world-map-legend-label-{{ ai_gen_id }}">{{ country_name }}</div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    {% endif %}
  </div>
</world-map-{{ ai_gen_id }}>

<script>
  (function() {
    class WorldMap{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.initMap();
      }

      initMap() {
        const pins = this.querySelectorAll('.ai-world-map-pin-{{ ai_gen_id }}');
        
        pins.forEach(pin => {
          const pulse = pin.querySelector('.ai-world-map-pin-pulse-{{ ai_gen_id }}');
          if (pulse) {
            this.animatePulse(pulse);
          }
        });
      }

      animatePulse(element) {
        let scale = 1;
        let growing = true;
        
        setInterval(() => {
          if (growing) {
            scale += 0.02;
            if (scale >= 1.5) growing = false;
          } else {
            scale -= 0.02;
            if (scale <= 1) growing = true;
          }
          
          element.style.transform = 'translate(-50%, -50%) scale(' + scale + ')';
          element.style.opacity = (1.6 - scale) * 0.6;
        }, 50);
      }
    }

    customElements.define('world-map-{{ ai_gen_id }}', WorldMap{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "World export map",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Our Global Reach"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "We proudly export our premium furniture to countries around the world"
    },
    {
      "type": "header",
      "content": "Map style"
    },
    {
      "type": "range",
      "id": "map_max_width",
      "min": 600,
      "max": 1400,
      "step": 100,
      "unit": "px",
      "label": "Maximum width",
      "default": 1200
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background",
      "default": "#f5f3ef"
    },
    {
      "type": "color",
      "id": "map_background",
      "label": "Map background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "land_color",
      "label": "Land color",
      "default": "#e8e4dc"
    },
    {
      "type": "color",
      "id": "land_hover_color",
      "label": "Land hover color",
      "default": "#d4cfc4"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border color",
      "default": "#c3bfb5"
    },
    {
      "type": "range",
      "id": "map_border_radius",
      "min": 0,
      "max": 40,
      "step": 4,
      "unit": "px",
      "label": "Border radius",
      "default": 16
    },
    {
      "type": "range",
      "id": "section_padding",
      "min": 20,
      "max": 100,
      "step": 10,
      "unit": "px",
      "label": "Section padding",
      "default": 60
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "title_size",
      "min": 20,
      "max": 60,
      "step": 2,
      "unit": "px",
      "label": "Title size",
      "default": 36
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "description_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Description size",
      "default": 16
    },
    {
      "type": "color",
      "id": "description_color",
      "label": "Description color",
      "default": "#666666"
    },
    {
      "type": "header",
      "content": "Pin style"
    },
    {
      "type": "range",
      "id": "pin_size",
      "min": 20,
      "max": 50,
      "step": 2,
      "unit": "px",
      "label": "Pin size",
      "default": 32
    },
    {
      "type": "color",
      "id": "tooltip_background",
      "label": "Tooltip background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "tooltip_text_color",
      "label": "Tooltip text",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Legend"
    },
    {
      "type": "checkbox",
      "id": "show_legend",
      "label": "Show legend",
      "default": true
    },
    {
      "type": "header",
      "content": "Country 1"
    },
    {
      "type": "checkbox",
      "id": "country_1",
      "label": "Enable country 1",
      "default": true
    },
    {
      "type": "text",
      "id": "country_1_name",
      "label": "Country name",
      "default": "India"
    },
    {
      "type": "range",
      "id": "country_1_x",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Horizontal position",
      "default": 65
    },
    {
      "type": "range",
      "id": "country_1_y",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Vertical position",
      "default": 45
    },
    {
      "type": "color",
      "id": "country_1_color",
      "label": "Pin color",
      "default": "#c3cca6"
    },
    {
      "type": "header",
      "content": "Country 2"
    },
    {
      "type": "checkbox",
      "id": "country_2",
      "label": "Enable country 2",
      "default": true
    },
    {
      "type": "text",
      "id": "country_2_name",
      "label": "Country name",
      "default": "USA"
    },
    {
      "type": "range",
      "id": "country_2_x",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Horizontal position",
      "default": 20
    },
    {
      "type": "range",
      "id": "country_2_y",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Vertical position",
      "default": 35
    },
    {
      "type": "color",
      "id": "country_2_color",
      "label": "Pin color",
      "default": "#a04637"
    },
    {
      "type": "header",
      "content": "Country 3"
    },
    {
      "type": "checkbox",
      "id": "country_3",
      "label": "Enable country 3",
      "default": true
    },
    {
      "type": "text",
      "id": "country_3_name",
      "label": "Country name",
      "default": "Canada"
    },
    {
      "type": "range",
      "id": "country_3_x",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Horizontal position",
      "default": 18
    },
    {
      "type": "range",
      "id": "country_3_y",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Vertical position",
      "default": 25
    },
    {
      "type": "color",
      "id": "country_3_color",
      "label": "Pin color",
      "default": "#a57f59"
    },
    {
      "type": "header",
      "content": "Country 4"
    },
    {
      "type": "checkbox",
      "id": "country_4",
      "label": "Enable country 4",
      "default": false
    },
    {
      "type": "text",
      "id": "country_4_name",
      "label": "Country name"
    },
    {
      "type": "range",
      "id": "country_4_x",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Horizontal position",
      "default": 50
    },
    {
      "type": "range",
      "id": "country_4_y",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Vertical position",
      "default": 50
    },
    {
      "type": "color",
      "id": "country_4_color",
      "label": "Pin color",
      "default": "#68807e"
    },
    {
      "type": "header",
      "content": "Country 5"
    },
    {
      "type": "checkbox",
      "id": "country_5",
      "label": "Enable country 5",
      "default": false
    },
    {
      "type": "text",
      "id": "country_5_name",
      "label": "Country name"
    },
    {
      "type": "range",
      "id": "country_5_x",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Horizontal position",
      "default": 50
    },
    {
      "type": "range",
      "id": "country_5_y",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Vertical position",
      "default": 50
    },
    {
      "type": "color",
      "id": "country_5_color",
      "label": "Pin color",
      "default": "#fdc656"
    },
    {
      "type": "header",
      "content": "Country 6"
    },
    {
      "type": "checkbox",
      "id": "country_6",
      "label": "Enable country 6",
      "default": false
    },
    {
      "type": "text",
      "id": "country_6_name",
      "label": "Country name"
    },
    {
      "type": "range",
      "id": "country_6_x",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Horizontal position",
      "default": 50
    },
    {
      "type": "range",
      "id": "country_6_y",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Vertical position",
      "default": 50
    },
    {
      "type": "color",
      "id": "country_6_color",
      "label": "Pin color",
      "default": "#c3cca6"
    },
    {
      "type": "header",
      "content": "Country 7"
    },
    {
      "type": "checkbox",
      "id": "country_7",
      "label": "Enable country 7",
      "default": false
    },
    {
      "type": "text",
      "id": "country_7_name",
      "label": "Country name"
    },
    {
      "type": "range",
      "id": "country_7_x",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Horizontal position",
      "default": 50
    },
    {
      "type": "range",
      "id": "country_7_y",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Vertical position",
      "default": 50
    },
    {
      "type": "color",
      "id": "country_7_color",
      "label": "Pin color",
      "default": "#a04637"
    },
    {
      "type": "header",
      "content": "Country 8"
    },
    {
      "type": "checkbox",
      "id": "country_8",
      "label": "Enable country 8",
      "default": false
    },
    {
      "type": "text",
      "id": "country_8_name",
      "label": "Country name"
    },
    {
      "type": "range",
      "id": "country_8_x",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Horizontal position",
      "default": 50
    },
    {
      "type": "range",
      "id": "country_8_y",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Vertical position",
      "default": 50
    },
    {
      "type": "color",
      "id": "country_8_color",
      "label": "Pin color",
      "default": "#a57f59"
    },
    {
      "type": "header",
      "content": "Country 9"
    },
    {
      "type": "checkbox",
      "id": "country_9",
      "label": "Enable country 9",
      "default": false
    },
    {
      "type": "text",
      "id": "country_9_name",
      "label": "Country name"
    },
    {
      "type": "range",
      "id": "country_9_x",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Horizontal position",
      "default": 50
    },
    {
      "type": "range",
      "id": "country_9_y",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Vertical position",
      "default": 50
    },
    {
      "type": "color",
      "id": "country_9_color",
      "label": "Pin color",
      "default": "#68807e"
    },
    {
      "type": "header",
      "content": "Country 10"
    },
    {
      "type": "checkbox",
      "id": "country_10",
      "label": "Enable country 10",
      "default": false
    },
    {
      "type": "text",
      "id": "country_10_name",
      "label": "Country name"
    },
    {
      "type": "range",
      "id": "country_10_x",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Horizontal position",
      "default": 50
    },
    {
      "type": "range",
      "id": "country_10_y",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Vertical position",
      "default": 50
    },
    {
      "type": "color",
      "id": "country_10_color",
      "label": "Pin color",
      "default": "#fdc656"
    }
  ],
  "presets": [
    {
      "name": "World export map"
    }
  ]
}
{% endschema %}